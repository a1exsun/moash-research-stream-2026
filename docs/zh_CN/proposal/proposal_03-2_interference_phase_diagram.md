# Proposal 03-2: 干扰相图与临界边界（IPD-CL）

## 目标

在持续学习中，不只比较“哪种方法分数更高”，而是识别：

1. 在什么条件下模型会进入高遗忘区（相变边界）
2. 不同方法是否能实质性移动该边界
3. 稀疏拓扑的收益是“局部提分”还是“改变系统相位”

本提议是 Proposal 03 的上位扩展：03 关注 dense vs 原生稀疏谁更优，03-2 关注遗忘何时必然发生、边界是否可移动。

---

## 第一性原理动机

遗忘的本质不是“分数下降”本身，而是：

- 新任务更新方向与旧知识敏感方向发生干扰
- 干扰累计超过系统的可塑容量后，旧知识不可逆损失

因此核心不是只看终点性能，而是估计“干扰-容量”比值与临界点。

---

## 研究问题

1. 是否存在可复现的遗忘临界边界（phase boundary）？
2. 该边界如何随任务冲突强度、序列长度、模型密度变化？
3. Dense / Sparse / CDCL / Selective Write 是在降低干扰、提升容量，还是两者同时发生？

---

## 假设

### H1
遗忘率随干扰强度与序列长度呈非线性增长，并存在临界区而非纯线性劣化。

### H2
结构化稀疏拓扑可将临界边界向“更高冲突、更长序列”方向推迟。

### H3
只做 dense 正则化通常改善局部区间，但难以系统性改变长期边界形状。

---

## 方法定义（机制量化）

定义：

1. 干扰比 `I_t = ||P_old g_t|| / ||g_t||`
2. 有效可塑容量 `C_t`（可写自由度近似，受拓扑/门控/约束影响）
3. 风险比 `R_t = I_t / C_t`

其中：

- `P_old` 为旧任务敏感子空间投影（可由 Fisher 主子空间或梯度协方差低秩近似得到）
- 当 `R_t` 长时间高于阈值时，系统进入高遗忘相

本提议不要求先证明唯一正确机理，而是要求 `R_t` 与遗忘有稳定统计关联。

---

## 实验设计

## 1. 可控冲突基准（核心）

构建三档任务冲突强度：

1. 低冲突（Low）
2. 中冲突（Mid）
3. 高冲突（High）

可通过控制新旧域标签规则重叠、指令模板冲突、目标映射冲突实现。关键要求是冲突等级可复现且可量化。

## 2. 方法矩阵

最小可执行组：

1. `M1`: Dense baseline
2. `M2`: Sparse topology（2:4，固定拓扑）
3. `M3`: Dense + CDCL（来自 Proposal 04）
4. `M4`: Sparse + Selective Write（来自 Proposal 01）

扩展组可后加，不影响主结论闭环。

## 3. 扫描维度

1. 序列长度 `T`：5/10/20 阶段
2. 冲突强度：Low/Mid/High
3. 稀疏密度 `rho`：如 0.3/0.5/0.7（按资源可裁剪）

## 4. 公平性与统计

1. same-shape、matched-nonzero、matched-FLOPs 至少报告两种
2. 每组 >=3 seeds，95% CI
3. 预注册主指标与主比较，避免后验选点

---

## 指标体系

结果指标：

1. Average Forgetting
2. BWT
3. Retention@k

机制指标：

1. `I_t`（干扰比）
2. `C_t`（有效可塑容量代理）
3. `R_t = I_t/C_t`
4. 子空间漂移距离

相图指标（本提议新增）：

1. 临界边界 `B`（高遗忘/低遗忘分界线）
2. 临界序列长度 `T*`
3. 临界冲突强度 `O*`

---

## 预期输出

1. 遗忘相图（横轴序列长度，纵轴冲突强度，颜色为遗忘率）
2. 不同方法的临界边界对比图（谁真正移动边界）
3. 对 Proposal 03 的结构化结论：
- 若原生稀疏仅提分不移边界：价值偏工程
- 若原生稀疏显著移边界：价值偏机制突破

---

## Go/No-Go 决策门槛

Go（继续投入）：

1. 观察到稳定、可复现的临界边界（跨 seed/顺序成立）
2. 至少一种方法相对 Dense 显著移动边界（而不只是单点提分）
3. 机制指标（特别是 `R_t`）与遗忘显著相关

No-Go（降级）：

1. 边界不可复现，仅有噪声型差异
2. 机制指标与遗忘弱相关
3. 额外开销明显高于信息增益

---

## 风险与应对

### 风险1：冲突强度构造不干净
应对：先在小模型做可分性和难度校准，避免“高冲突=高难度”混淆。

### 风险2：`C_t` 估计定义不稳
应对：并行使用两种容量代理（参数自由度代理 + 梯度秩代理）做稳健性检查。

### 风险3：实验网格过大
应对：先跑最小网格（2 方法 x 2 冲突 x 5 阶段）拿首张相图，再扩展。

---

## 里程碑

1. Week 1：完成冲突基准构建与校准；跑最小网格
2. Week 2：完成 4 方法主矩阵（短序列）
3. Week 3：扩展到长序列（>=20 阶段）并估计临界边界
4. Week 4：完成统计建模与对 Proposal 03 的路线决策

---

## 与其他提议的关系

1. Proposal 03：提供 dense vs 原生稀疏的核心对照切片
2. Proposal 01：提供可组合机制（Selective Write / Replay 等）
3. Proposal 04：提供干扰子空间约束机制（CDCL）
4. Proposal 03-2：统一这些方法到“临界边界是否被移动”的同一评价框架
